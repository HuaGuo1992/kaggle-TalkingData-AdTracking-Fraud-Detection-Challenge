/home/guohuajiaohuazi/anaconda3/lib/python3.6/site-packages/sklearn/cross_validation.py:41: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
/home/guohuajiaohuazi/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py:1036: UserWarning: Using categorical_feature in Dataset.
  warnings.warn('Using categorical_feature in Dataset.')
/home/guohuajiaohuazi/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py:681: UserWarning: categorical_feature in param dict is overrided.
  warnings.warn('categorical_feature in param dict is overrided.')
loading train data... 94903890 184903890
loading test data...
Extracting new features...
selcols ['ip', 'channel'] QQ 4
selcols ['ip', 'device', 'os', 'app'] QQ 5
selcols ['ip', 'day', 'hour'] QQ 4
selcols ['ip', 'app'] QQ 4
selcols ['ip', 'app', 'os'] QQ 4
selcols ['ip', 'device'] QQ 4
selcols ['app', 'channel'] QQ 4
selcols ['ip', 'os'] QQ 5
selcols ['ip', 'device', 'os', 'app'] QQ 4
doing nextClick
saving
grouping by ip-day-hour combination...
grouping by ip-app combination...
grouping by ip-app-os combination...
grouping by : ip_day_chl_var_hour
grouping by : ip_app_os_var_hour
grouping by : ip_app_channel_var_day
grouping by : ip_app_chl_mean_hour
merging...
vars and data type: 
<class 'pandas.core.frame.DataFrame'>
Int64Index: 108790469 entries, 0 to 108790468
Data columns (total 30 columns):
app                         uint16
channel                     uint16
click_id                    float64
click_time                  datetime64[ns]
device                      uint16
ip                          uint32
is_attributed               float64
os                          uint16
hour                        uint8
day                         uint8
X0                          int64
X1                          int64
X2                          int64
X3                          int64
X4                          int64
X5                          int64
X6                          int64
X7                          int64
X8                          int64
category                    int64
epochtime                   int64
nextClick                   int64
nextClick_shift             float64
ip_tcount                   int64
ip_app_count                int64
ip_app_os_count             int64
ip_tchan_count              float64
ip_app_os_var               float64
ip_app_channel_var_day      float64
ip_app_channel_mean_hour    float64
dtypes: datetime64[ns](1), float64(7), int64(15), uint16(4), uint32(1), uint8(2)
memory usage: 20.9 GB
predictors ['nextClick', 'nextClick_shift', 'app', 'device', 'os', 'channel', 'hour', 'day', 'ip_tcount', 'ip_tchan_count', 'ip_app_count', 'ip_app_os_count', 'ip_app_os_var', 'ip_app_channel_var_day', 'ip_app_channel_mean_hour', 'X0', 'X1', 'X2', 'X3', 'X4', 'X5', 'X6', 'X7', 'X8']
train size:  87500000
valid size:  2500000
test size :  18790469
Training...
preparing validation datasets
Training until validation scores don't improve for 30 rounds.
[10]	train's auc: 0.96544	valid's auc: 0.976235
[20]	train's auc: 0.9696	valid's auc: 0.978873
[30]	train's auc: 0.972022	valid's auc: 0.979386
[40]	train's auc: 0.974019	valid's auc: 0.981409
[50]	train's auc: 0.976093	valid's auc: 0.982516
[60]	train's auc: 0.977288	valid's auc: 0.983429
[70]	train's auc: 0.97844	valid's auc: 0.984777
[80]	train's auc: 0.979358	valid's auc: 0.985866
[90]	train's auc: 0.979986	valid's auc: 0.986615
[100]	train's auc: 0.980438	valid's auc: 0.987136
[110]	train's auc: 0.980826	valid's auc: 0.987493
[120]	train's auc: 0.981164	valid's auc: 0.987916
[130]	train's auc: 0.981401	valid's auc: 0.988135
[140]	train's auc: 0.981591	valid's auc: 0.988425
[150]	train's auc: 0.981821	valid's auc: 0.988697
[160]	train's auc: 0.981983	valid's auc: 0.988757
[170]	train's auc: 0.982124	valid's auc: 0.988877
[180]	train's auc: 0.982274	valid's auc: 0.988957
[190]	train's auc: 0.982392	valid's auc: 0.989045
[200]	train's auc: 0.982513	valid's auc: 0.989144
[210]	train's auc: 0.982656	valid's auc: 0.989242
[220]	train's auc: 0.982747	valid's auc: 0.989241
[230]	train's auc: 0.982841	valid's auc: 0.98935
[240]	train's auc: 0.982966	valid's auc: 0.989414
[250]	train's auc: 0.983079	valid's auc: 0.989472
[260]	train's auc: 0.983189	valid's auc: 0.989538
[270]	train's auc: 0.983271	valid's auc: 0.98969
[280]	train's auc: 0.983345	valid's auc: 0.989671
[290]	train's auc: 0.983417	valid's auc: 0.989704
[300]	train's auc: 0.983481	valid's auc: 0.989764
[310]	train's auc: 0.98355	valid's auc: 0.989845
[320]	train's auc: 0.983617	valid's auc: 0.989938
[330]	train's auc: 0.98368	valid's auc: 0.989967
[340]	train's auc: 0.983745	valid's auc: 0.990035
[350]	train's auc: 0.983799	valid's auc: 0.990071
[360]	train's auc: 0.983848	valid's auc: 0.990166
[370]	train's auc: 0.983896	valid's auc: 0.990197
[380]	train's auc: 0.983946	valid's auc: 0.990218
[390]	train's auc: 0.984001	valid's auc: 0.990253
[400]	train's auc: 0.984042	valid's auc: 0.990261
[410]	train's auc: 0.984084	valid's auc: 0.990238
[420]	train's auc: 0.984127	valid's auc: 0.990277
[430]	train's auc: 0.984164	valid's auc: 0.990296
[440]	train's auc: 0.984204	valid's auc: 0.990314
[450]	train's auc: 0.984246	valid's auc: 0.990324
[460]	train's auc: 0.984275	valid's auc: 0.990346
[470]	train's auc: 0.984311	valid's auc: 0.990371
[480]	train's auc: 0.984347	valid's auc: 0.990419
[490]	train's auc: 0.984383	valid's auc: 0.990448
[500]	train's auc: 0.98442	valid's auc: 0.990466
[510]	train's auc: 0.984446	valid's auc: 0.990484
[520]	train's auc: 0.984473	valid's auc: 0.99048
[530]	train's auc: 0.984503	valid's auc: 0.9905
[540]	train's auc: 0.984536	valid's auc: 0.990513
[550]	train's auc: 0.984566	valid's auc: 0.990522
[560]	train's auc: 0.984599	valid's auc: 0.990537
[570]	train's auc: 0.984625	valid's auc: 0.990555
[580]	train's auc: 0.984647	valid's auc: 0.990592
[590]	train's auc: 0.984675	valid's auc: 0.990611
[600]	train's auc: 0.9847	valid's auc: 0.990595
[610]	train's auc: 0.984725	valid's auc: 0.990602
[620]	train's auc: 0.984756	valid's auc: 0.990622
[630]	train's auc: 0.984778	valid's auc: 0.990643
[640]	train's auc: 0.984802	valid's auc: 0.990651
[650]	train's auc: 0.984824	valid's auc: 0.990656
[660]	train's auc: 0.984847	valid's auc: 0.990666
[670]	train's auc: 0.984867	valid's auc: 0.990656
[680]	train's auc: 0.984886	valid's auc: 0.990684
[690]	train's auc: 0.984911	valid's auc: 0.990683
[700]	train's auc: 0.984933	valid's auc: 0.990683
[710]	train's auc: 0.984958	valid's auc: 0.990695
[720]	train's auc: 0.984981	valid's auc: 0.990714
[730]	train's auc: 0.985001	valid's auc: 0.990718
[740]	train's auc: 0.985023	valid's auc: 0.990724
[750]	train's auc: 0.985046	valid's auc: 0.990736
[760]	train's auc: 0.985065	valid's auc: 0.99075
[770]	train's auc: 0.985082	valid's auc: 0.990751
[780]	train's auc: 0.985098	valid's auc: 0.990756
[790]	train's auc: 0.985117	valid's auc: 0.990765
[800]	train's auc: 0.98514	valid's auc: 0.99077
[810]	train's auc: 0.985162	valid's auc: 0.990774
[820]	train's auc: 0.985179	valid's auc: 0.990765
[830]	train's auc: 0.985198	valid's auc: 0.990774
[840]	train's auc: 0.985213	valid's auc: 0.990769
[850]	train's auc: 0.98523	valid's auc: 0.990778
[860]	train's auc: 0.985243	valid's auc: 0.990772
[870]	train's auc: 0.985256	valid's auc: 0.990756
Early stopping, best iteration is:
[847]	train's auc: 0.985225	valid's auc: 0.99078

Model Report
bst1.best_iteration:  847
auc: 0.9907799125051798
[54843.0318133831]: model training time
Plot feature importances...
Predicting...
writing...
done...
