/home/guohuajiaohuazi/anaconda3/lib/python3.6/site-packages/sklearn/cross_validation.py:41: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  "This module will be removed in 0.20.", DeprecationWarning)
/home/guohuajiaohuazi/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py:1036: UserWarning: Using categorical_feature in Dataset.
  warnings.warn('Using categorical_feature in Dataset.')
/home/guohuajiaohuazi/anaconda3/lib/python3.6/site-packages/lightgbm/basic.py:681: UserWarning: categorical_feature in param dict is overrided.
  warnings.warn('categorical_feature in param dict is overrided.')
loading train data... 903890 184903890
loading test data...
Extracting new features...
>> Calculating confidence-weighted rate for: ['channel'].
   Saving to: channel_confRate. Group Max /Mean / Median / Min: 15025713 / 910891.09 / 107750.5 / 1
(184000000, 9)
shape of train:  (184000000, 9)
shape of test:  (18790469, 9)
selcols ['ip', 'channel'] QQ 4
selcols ['ip', 'device', 'os', 'app'] QQ 4
selcols ['ip', 'app', 'device', 'os'] QQ NC
variables and data type: 
<class 'pandas.core.frame.DataFrame'>
Int64Index: 202790469 entries, 0 to 202790468
Data columns (total 13 columns):
app                    uint16
channel                uint16
channel_confRate       float64
click_id               float64
click_time             int32
device                 uint16
hour                   uint8
ip                     uint32
is_attributed          float64
os                     uint16
ip_channel_4           int64
ip_device_os_app_4     int64
ip_app_device_os_NC    float32
dtypes: float32(1), float64(3), int32(1), int64(2), uint16(4), uint32(1), uint8(1)
memory usage: 13.0 GB
predictors ['channel_confRate', 'ip_channel_4', 'ip_device_os_app_4', 'ip_app_device_os_NC', 'ip', 'app', 'os', 'channel', 'device', 'hour']
train size:  159000000
valid size:  25000000
test size :  18790469
Training...
preparing validation datasets
Training until validation scores don't improve for 30 rounds.
[10]	train's auc: 0.966992	valid's auc: 0.960154
[20]	train's auc: 0.972047	valid's auc: 0.966158
[30]	train's auc: 0.97494	valid's auc: 0.969884
[40]	train's auc: 0.976394	valid's auc: 0.972126
[50]	train's auc: 0.978072	valid's auc: 0.974323
[60]	train's auc: 0.979282	valid's auc: 0.975946
[70]	train's auc: 0.980118	valid's auc: 0.977167
[80]	train's auc: 0.980829	valid's auc: 0.978124
[90]	train's auc: 0.981319	valid's auc: 0.978904
[100]	train's auc: 0.981763	valid's auc: 0.97952
[110]	train's auc: 0.982124	valid's auc: 0.980005
[120]	train's auc: 0.982345	valid's auc: 0.98035
[130]	train's auc: 0.982577	valid's auc: 0.98067
[140]	train's auc: 0.982751	valid's auc: 0.980946
[150]	train's auc: 0.982947	valid's auc: 0.981135
[160]	train's auc: 0.983108	valid's auc: 0.981409
[170]	train's auc: 0.983255	valid's auc: 0.98159
[180]	train's auc: 0.983377	valid's auc: 0.981743
[190]	train's auc: 0.983504	valid's auc: 0.981867
[200]	train's auc: 0.983614	valid's auc: 0.981988
[210]	train's auc: 0.983709	valid's auc: 0.982122
[220]	train's auc: 0.983777	valid's auc: 0.982203
[230]	train's auc: 0.983863	valid's auc: 0.982335
[240]	train's auc: 0.983933	valid's auc: 0.982454
[250]	train's auc: 0.984022	valid's auc: 0.982553
[260]	train's auc: 0.984085	valid's auc: 0.982607
[270]	train's auc: 0.984146	valid's auc: 0.982692
[280]	train's auc: 0.984217	valid's auc: 0.98277
[290]	train's auc: 0.984284	valid's auc: 0.982836
[300]	train's auc: 0.984343	valid's auc: 0.982894
[310]	train's auc: 0.984398	valid's auc: 0.982955
[320]	train's auc: 0.984449	valid's auc: 0.983022
[330]	train's auc: 0.984491	valid's auc: 0.983076
[340]	train's auc: 0.984538	valid's auc: 0.983141
[350]	train's auc: 0.984588	valid's auc: 0.983182
[360]	train's auc: 0.984625	valid's auc: 0.983227
[370]	train's auc: 0.984664	valid's auc: 0.983272
[380]	train's auc: 0.984702	valid's auc: 0.983309
[390]	train's auc: 0.984739	valid's auc: 0.983346
[400]	train's auc: 0.984763	valid's auc: 0.983373
[410]	train's auc: 0.984796	valid's auc: 0.98341
[420]	train's auc: 0.98483	valid's auc: 0.98344
[430]	train's auc: 0.984859	valid's auc: 0.983464
[440]	train's auc: 0.984893	valid's auc: 0.983497
[450]	train's auc: 0.984923	valid's auc: 0.98352
[460]	train's auc: 0.984945	valid's auc: 0.983549
[470]	train's auc: 0.984972	valid's auc: 0.983556
[480]	train's auc: 0.985003	valid's auc: 0.983593
[490]	train's auc: 0.985033	valid's auc: 0.983621
[500]	train's auc: 0.985056	valid's auc: 0.983641
[510]	train's auc: 0.98508	valid's auc: 0.983666
[520]	train's auc: 0.985102	valid's auc: 0.983687
[530]	train's auc: 0.985124	valid's auc: 0.983708
[540]	train's auc: 0.985148	valid's auc: 0.983729
[550]	train's auc: 0.98517	valid's auc: 0.983744
[560]	train's auc: 0.985188	valid's auc: 0.983758
[570]	train's auc: 0.985205	valid's auc: 0.983773
[580]	train's auc: 0.985221	valid's auc: 0.983791
[590]	train's auc: 0.985238	valid's auc: 0.983794
[600]	train's auc: 0.985253	valid's auc: 0.983805
[610]	train's auc: 0.985273	valid's auc: 0.98381
[620]	train's auc: 0.985294	valid's auc: 0.98382
[630]	train's auc: 0.985311	valid's auc: 0.983831
[640]	train's auc: 0.985329	valid's auc: 0.983839
[650]	train's auc: 0.985346	valid's auc: 0.983845
[660]	train's auc: 0.985362	valid's auc: 0.983849
[670]	train's auc: 0.985374	valid's auc: 0.983851
[680]	train's auc: 0.98539	valid's auc: 0.983859
[690]	train's auc: 0.985402	valid's auc: 0.983866
[700]	train's auc: 0.985416	valid's auc: 0.983873
[710]	train's auc: 0.985432	valid's auc: 0.983889
[720]	train's auc: 0.985443	valid's auc: 0.983887
[730]	train's auc: 0.985458	valid's auc: 0.983899
[740]	train's auc: 0.985473	valid's auc: 0.983907
[750]	train's auc: 0.985487	valid's auc: 0.983923
[760]	train's auc: 0.985498	valid's auc: 0.983926
[770]	train's auc: 0.985508	valid's auc: 0.983932
[780]	train's auc: 0.98552	valid's auc: 0.983936
[790]	train's auc: 0.985531	valid's auc: 0.983941
[800]	train's auc: 0.985542	valid's auc: 0.983942
[810]	train's auc: 0.985554	valid's auc: 0.983948
[820]	train's auc: 0.985565	valid's auc: 0.98395
[830]	train's auc: 0.985575	valid's auc: 0.983954
[840]	train's auc: 0.985589	valid's auc: 0.983954
[850]	train's auc: 0.9856	valid's auc: 0.983958
[860]	train's auc: 0.985613	valid's auc: 0.983959
[870]	train's auc: 0.985623	valid's auc: 0.983959
[880]	train's auc: 0.985634	valid's auc: 0.983959
[890]	train's auc: 0.985642	valid's auc: 0.983955
Early stopping, best iteration is:
[863]	train's auc: 0.985616	valid's auc: 0.983961

Model Report
bst1.best_iteration:  863
auc: 0.9839614901336897
[46377.890135765076]: model training time
Plot feature importances...
Predicting...
writing...
done...
